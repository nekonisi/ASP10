Day08-2
===

# 概要

- エディタ/カタログパーツでWebパーツの設定を編集しよう！

## このレッスンの狙い

- エディタ/カタログパーツを利用することで、Webパーツのプロパティ値を編集したり、一度閉じたWebパーツを再配置したりといった機能をブラウザ上に追加することが可能。

## カタログパーツ

- ページがカタログモードにある場合に表示されるパーツで、ページ内に追加可能なWebパーツの一覧を表示・追加するための手段を提供する。

### `PageCatalogPart`コントロール

- ページ内であらかじめ静的に定義されたWebパーツをカタログ表示する。
- 再配置したいWebパーツと、「追加」欄から追加先のゾーンを選択した上で、「追加」ボタンをクリックすると、Webパーツを追加することができる。

### `DeclarativeCatalogPart`コントロール(宣言カタログ)

- `PageCatalogPart`コントロールがデフォルト表示すべきWebパーツを管理するのに対して、`DeclarativeCatalogPart`コントロールはあとから追加するためのカタログである。

#### 使用方法

- `DeclarativeCatalogPart`コントロールを使用するには、デザインビューに配置したうえで、コンテキストメニューから[テンプレート編集] - [WebPartsTemplate]を選択する。
- `WebPartsTemplate`テンプレートの中に、カタログとして追加したいWebパーツを配置する。
- `WebPartZone`コントロールに配置された場合と同様、`GenericWebPart`クラスでラッピングされますので、コードエディタから適宜、必要なプロパティ情報を設定することが可能です。

### `ImportCatalogPart`コントロール(インポートWebパーツカタログ)

- `WebParts`コントロール、現在のWebパーツ設定を`.webpart`ファイルとしてエクスポート
- インポート/エクスポート機能を利用することで、あるユーザがパーソナライズした情報をエクスポートしておき、そのファイルを別のユーザ環境でインポートすることでそのまま適用する。といった用途が可能になる。

```VB.NET:Webパーツに対してExportModeプロパティ

<uc3:RssReader ID="reader" runat="server"
  RssFeed="http://www.wings.msn.to/redirect.php/-/A-12"
	Title="サーバサイド技術の学び舎 - WINGS"
	ExportMode="All" />

```

- また構成ファイル(web.config)に対して`<webParts>`要素を追加する。

```VB.NET:web.config

  </httpModules>
  <webParts enableExport="true" />
</system.web>

```

- これによって、該当するWebパーツのメニューから[エクスポート]コマンドが選択できる。
- エクスポートされた`.webpart`ファイルは、`ImportCatalogPart`コントロールからインポートすることが可能。

## まとめ

[TOPへ](./index.md)  
